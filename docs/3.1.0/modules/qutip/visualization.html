
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>qutip.visualization &mdash; QuTiP 3.1.0 Documentation</title>
    
    <link rel="stylesheet" href="../../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../static/bootswatch-3.2.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../static/site.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/underscore.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../static/favicon.ico"/>
    <link rel="top" title="QuTiP 3.1.0 Documentation" href="../../index.html" />
    <link rel="up" title="qutip" href="../qutip.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QuTiP</a>
        <span class="navbar-text navbar-version pull-left"><b>3.1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="http://qutip.org">qutip.org</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Docs <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../frontmatter.html">Frontmatter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../frontmatter.html#about-this-documentation">About This Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontmatter.html#citing-this-project">Citing This Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontmatter.html#funding">Funding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontmatter.html#about-qutip">About QuTiP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontmatter.html#contributing-to-qutip">Contributing to QuTiP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#general-requirements">General Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#platform-independent-installation">Platform-independent installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#get-the-source-code">Get the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installing-from-source">Installing from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installation-on-ubuntu-linux">Installation on Ubuntu Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installation-on-mac-os-x-10-8">Installation on Mac OS X (10.8+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installation-on-windows">Installation on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#optional-installation-options">Optional Installation Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#verifying-the-installation">Verifying the Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#checking-version-information-using-the-about-function">Checking Version Information using the About Function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../guide/guide.html">Users Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-overview.html">Guide Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-basics.html">Basic Operations on Quantum Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-states.html">Manipulating States and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-tensor.html">Using Tensor Products and Partial Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-dynamics.html">Time Evolution and Quantum System Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-steady.html">Solving for Steady-State Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-eseries.html">An Overview of the Eseries Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-correlation.html">Two-time correlation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-bloch.html">Plotting on the Bloch Sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-visualization.html">Visualization of quantum states and processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-parfor.html">Parallel computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-saving.html">Saving QuTiP Objects and Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-random.html">Generating Random Quantum States &amp; Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/guide-settings.html">Modifying Internal QuTiP Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../apidoc/apidoc.html">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../apidoc/classes.html">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidoc/functions.html">Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-3-1-0-january-1-2015">Version 3.1.0 (January 1, 2015):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-3-0-1-aug-5-2014">Version 3.0.1 (Aug 5, 2014):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-3-0-0-july-17-2014">Version 3.0.0 (July 17, 2014):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-2-2-0-march-01-2013">Version 2.2.0 (March 01, 2013):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-2-1-0-october-05-2012">Version 2.1.0 (October 05, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-2-0-0-june-01-2012">Version 2.0.0 (June 01, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-1-1-4-may-28-2012">Version 1.1.4 (May 28, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-1-1-3-november-21-2011">Version 1.1.3 (November 21, 2011):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-1-1-2-october-27-2011">Version 1.1.2 (October 27, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-1-1-1-october-25-2011">Version 1.1.1 (October 25, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-1-1-0-october-04-2011">Version 1.1.0 (October 04, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-1-0-0-july-29-2011">Version 1.0.0 (July 29, 2011)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Developers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributors.html#lead-developers">Lead Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../biblio.html">Bibliography</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <h1>Source code for qutip.visualization</h1><div class="highlight"><pre>
<span class="c"># This file is part of QuTiP: Quantum Toolbox in Python.</span>
<span class="c">#</span>
<span class="c">#    Copyright (c) 2011 and later, Paul D. Nation and Robert J. Johansson.</span>
<span class="c">#    All rights reserved.</span>
<span class="c">#</span>
<span class="c">#    Redistribution and use in source and binary forms, with or without</span>
<span class="c">#    modification, are permitted provided that the following conditions are</span>
<span class="c">#    met:</span>
<span class="c">#</span>
<span class="c">#    1. Redistributions of source code must retain the above copyright notice,</span>
<span class="c">#       this list of conditions and the following disclaimer.</span>
<span class="c">#</span>
<span class="c">#    2. Redistributions in binary form must reproduce the above copyright</span>
<span class="c">#       notice, this list of conditions and the following disclaimer in the</span>
<span class="c">#       documentation and/or other materials provided with the distribution.</span>
<span class="c">#</span>
<span class="c">#    3. Neither the name of the QuTiP: Quantum Toolbox in Python nor the names</span>
<span class="c">#       of its contributors may be used to endorse or promote products derived</span>
<span class="c">#       from this software without specific prior written permission.</span>
<span class="c">#</span>
<span class="c">#    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="c">#    &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="c">#    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A</span>
<span class="c">#    PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="c">#    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c">#    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c">#    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="c">#    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="c">#    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="c">#    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c">#    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for visualizing results of quantum dynamics simulations,</span>
<span class="sd">visualizations of quantum states and processes.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hinton&#39;</span><span class="p">,</span> <span class="s">&#39;sphereplot&#39;</span><span class="p">,</span> <span class="s">&#39;energy_level_diagram&#39;</span><span class="p">,</span>
           <span class="s">&#39;plot_energy_levels&#39;</span><span class="p">,</span> <span class="s">&#39;fock_distribution&#39;</span><span class="p">,</span>
           <span class="s">&#39;plot_fock_distribution&#39;</span><span class="p">,</span> <span class="s">&#39;wigner_fock_distribution&#39;</span><span class="p">,</span>
           <span class="s">&#39;plot_wigner_fock_distribution&#39;</span><span class="p">,</span> <span class="s">&#39;plot_wigner&#39;</span><span class="p">,</span>
           <span class="s">&#39;plot_expectation_values&#39;</span><span class="p">,</span> <span class="s">&#39;plot_spin_distribution_2d&#39;</span><span class="p">,</span>
           <span class="s">&#39;plot_spin_distribution_3d&#39;</span><span class="p">,</span> <span class="s">&#39;plot_qubism&#39;</span><span class="p">,</span> <span class="s">&#39;plot_schmidt&#39;</span><span class="p">,</span>
           <span class="s">&#39;complex_array_to_rgb&#39;</span><span class="p">,</span> <span class="s">&#39;matrix_histogram&#39;</span><span class="p">,</span>
           <span class="s">&#39;matrix_histogram_complex&#39;</span><span class="p">,</span> <span class="s">&#39;sphereplot&#39;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">itertools</span> <span class="kn">as</span> <span class="nn">it</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">angle</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mpl</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">from</span> <span class="nn">qutip.qobj</span> <span class="kn">import</span> <span class="n">Qobj</span><span class="p">,</span> <span class="n">isket</span>
<span class="kn">from</span> <span class="nn">qutip.states</span> <span class="kn">import</span> <span class="n">ket2dm</span>
<span class="kn">from</span> <span class="nn">qutip.wigner</span> <span class="kn">import</span> <span class="n">wigner</span>
<span class="kn">from</span> <span class="nn">qutip.tensor</span> <span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span> <span class="nn">qutip.matplotlib_utilities</span> <span class="kn">import</span> <span class="n">complex_phase_cmap</span>
<span class="kn">from</span> <span class="nn">qutip.superoperator</span> <span class="kn">import</span> <span class="n">vector_to_operator</span>
<span class="kn">from</span> <span class="nn">qutip.superop_reps</span> <span class="kn">import</span> <span class="n">_pauli_basis</span><span class="p">,</span> <span class="n">to_super</span>
<span class="kn">from</span> <span class="nn">qutip.tensor</span> <span class="kn">import</span> <span class="n">flatten</span>

<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="n">settings</span>


<span class="c"># Adopted from the SciPy Cookbook.</span>
<span class="k">def</span> <span class="nf">_blob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">w_max</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws a square-shaped blob with the given area (&lt; 1) at</span>
<span class="sd">    the given coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">xcorners</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">x</span> <span class="o">-</span> <span class="n">hs</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">hs</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">hs</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">hs</span><span class="p">])</span>
    <span class="n">ycorners</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">y</span> <span class="o">-</span> <span class="n">hs</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">hs</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">hs</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">hs</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">xcorners</span><span class="p">,</span> <span class="n">ycorners</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">w</span> <span class="o">+</span> <span class="n">w_max</span><span class="p">)</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">w_max</span><span class="p">))))</span>


<span class="k">def</span> <span class="nf">_isqubitdims</span><span class="p">(</span><span class="n">dims</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks whether all entries in a dims list are integer powers of 2.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dims : nested list of ints</span>
<span class="sd">        Dimensions to be checked.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    isqubitdims : bool</span>
<span class="sd">        True if and only if every member of the flattened dims</span>
<span class="sd">        list is an integer power of 2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">([</span>
        <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span> <span class="o">==</span> <span class="n">dim</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>
    <span class="p">])</span>


<span class="k">def</span> <span class="nf">_cb_labels</span><span class="p">(</span><span class="n">left_dims</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates plot labels for matrix elements in the computational basis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    left_dims : flat list of ints</span>
<span class="sd">        Dimensions of the left index of a density operator. E. g.</span>
<span class="sd">        [2, 3] for a qubit tensored with a qutrit.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    left_labels, right_labels : lists of strings</span>
<span class="sd">        Labels for the left and right indices of a density operator</span>
<span class="sd">        (kets and bras, respectively).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: assumes dims, such that we only need left_dims == dims[0].</span>
    <span class="n">basis_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">[</span>
        <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">left_dims</span>
    <span class="p">])))</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="nb">map</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">basis_labels</span><span class="p">)</span> <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span>
        <span class="p">(</span>
            <span class="s">r&quot;$|{}\rangle$&quot;</span><span class="p">,</span>
            <span class="s">r&quot;$\langle{}|$&quot;</span>
        <span class="p">)</span>
    <span class="p">]</span>


<span class="c"># Adopted from the SciPy Cookbook.</span>
<div class="viewcode-block" id="hinton"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.hinton">[docs]</a><span class="k">def</span> <span class="nf">hinton</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">xlabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
           <span class="n">label_top</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws a Hinton diagram for visualizing a density matrix or superoperator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : qobj</span>
<span class="sd">        Input density matrix or superoperator.</span>

<span class="sd">    xlabels : list of strings or False</span>
<span class="sd">        list of x labels</span>

<span class="sd">    ylabels : list of strings or False</span>
<span class="sd">        list of y labels</span>

<span class="sd">    title : string</span>
<span class="sd">        title of the plot (optional)</span>

<span class="sd">    ax : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    cmap : a matplotlib colormap instance</span>
<span class="sd">        Color map to use when plotting.</span>

<span class="sd">    label_top : bool</span>
<span class="sd">        If True, x-axis labels will be placed on top, otherwise</span>
<span class="sd">        they will appear below the plot.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Input argument is not a quantum object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Apply default colormaps.</span>
    <span class="c"># TODO: abstract this away into something that makes default</span>
    <span class="c">#       colormaps.</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys_r</span> <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">colorblind_safe</span> <span class="k">else</span> <span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">cmap</span>
    <span class="p">)</span>

    <span class="c"># Extract plotting data W from the input.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">rho</span><span class="o">.</span><span class="n">isoper</span><span class="p">:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>

            <span class="c"># Create default labels if none are given.</span>
            <span class="k">if</span> <span class="n">xlabels</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">ylabels</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">_cb_labels</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">xlabels</span> <span class="o">=</span> <span class="n">xlabels</span> <span class="k">if</span> <span class="n">xlabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ylabels</span> <span class="o">=</span> <span class="n">ylabels</span> <span class="k">if</span> <span class="n">ylabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">rho</span><span class="o">.</span><span class="n">isoperket</span><span class="p">:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">vector_to_operator</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">rho</span><span class="o">.</span><span class="n">isoperbra</span><span class="p">:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">vector_to_operator</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">rho</span><span class="o">.</span><span class="n">issuper</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_isqubitdims</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Hinton plots of superoperators are &quot;</span>
                                 <span class="s">&quot;currently only supported for qubits.&quot;</span><span class="p">)</span>
            <span class="c"># Convert to a superoperator in the Pauli basis,</span>
            <span class="c"># so that all the elements are real.</span>
            <span class="n">sqobj</span> <span class="o">=</span> <span class="n">to_super</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
            <span class="n">nq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">sqobj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">_pauli_basis</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">nq</span><span class="p">)</span>
            <span class="c"># To do this, we have to hack a bit and force the dims to match,</span>
            <span class="c"># since the _pauli_basis function makes different assumptions</span>
            <span class="c"># about indices than we need here.</span>
            <span class="n">B</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="n">sqobj</span><span class="o">.</span><span class="n">dims</span>
            <span class="n">sqobj</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">sqobj</span> <span class="o">*</span> <span class="n">B</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">sqobj</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
            <span class="c"># Create default labels, too.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">xlabels</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ylabels</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">it</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="s">&quot;IXYZ&quot;</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">nq</span><span class="p">)))</span>
                <span class="n">xlabels</span> <span class="o">=</span> <span class="n">xlabels</span> <span class="k">if</span> <span class="n">xlabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">labels</span>
                <span class="n">ylabels</span> <span class="o">=</span> <span class="n">ylabels</span> <span class="k">if</span> <span class="n">ylabels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">labels</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s">&quot;Input quantum object must be an operator or superoperator.&quot;</span>
            <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">rho</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">xlabels</span> <span class="ow">or</span> <span class="n">ylabels</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">w_max</span> <span class="o">=</span> <span class="mf">1.25</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">W</span><span class="p">))))</span>
    <span class="k">if</span> <span class="n">w_max</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">w_max</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">height</span><span class="p">]),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
            <span class="n">_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">_blob</span><span class="p">(</span><span class="n">_x</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="n">_y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">x</span><span class="p">,</span>
                      <span class="n">y</span><span class="p">]),</span> <span class="n">w_max</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">/</span> <span class="n">w_max</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_blob</span><span class="p">(</span><span class="n">_x</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="n">_y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">[</span>
                      <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span> <span class="n">w_max</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">/</span> <span class="n">w_max</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c"># color axis</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c"># x axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">xlabels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_top</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c"># y axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ylabels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">ylabels</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="sphereplot"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.sphereplot">[docs]</a><span class="k">def</span> <span class="nf">sphereplot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots a matrix of values on a sphere</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    theta : float</span>
<span class="sd">        Angle with respect to z-axis</span>

<span class="sd">    phi : float</span>
<span class="sd">        Angle in x-y plane</span>

<span class="sd">    values : array</span>
<span class="sd">        Data set to be plotted</span>

<span class="sd">    fig : a matplotlib Figure instance</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    save : bool {False , True}</span>
<span class="sd">        Whether to save the figure or not</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="n">thetam</span><span class="p">,</span> <span class="n">phim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">thetam</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">phim</span><span class="p">)</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">thetam</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phim</span><span class="p">)</span>
    <span class="n">zz</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">thetam</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
    <span class="n">ph</span> <span class="o">=</span> <span class="n">angle</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="c"># normalize color range based on phase angles in list ph</span>
    <span class="n">nrm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">ph</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">ph</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="c"># plot with facecolors set to cm.jet colormap normalized to nrm</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">xx</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span> <span class="n">yy</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span> <span class="n">zz</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">facecolors</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">nrm</span><span class="p">(</span><span class="n">ph</span><span class="p">)),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c"># create new axes on plot for colorbar and shrink it a bit.</span>
    <span class="c"># pad shifts location of bar with repsect to the main plot</span>
    <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=.</span><span class="mi">66</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mo">02</span><span class="p">)</span>

    <span class="c"># create new colorbar in axes cax with cm jet and normalized to nrm like</span>
    <span class="c"># our facecolors</span>
    <span class="n">cb1</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">nrm</span><span class="p">)</span>
    <span class="c"># add our colorbar label</span>
    <span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;Angle&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;sphereplot.png&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="matrix_histogram"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.matrix_histogram">[docs]</a><span class="k">def</span> <span class="nf">matrix_histogram</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">xlabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a histogram for the matrix M, with the given x and y labels and title.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : Matrix of Qobj</span>
<span class="sd">        The matrix to visualize</span>

<span class="sd">    xlabels : list of strings</span>
<span class="sd">        list of x labels</span>

<span class="sd">    ylabels : list of strings</span>
<span class="sd">        list of y labels</span>

<span class="sd">    title : string</span>
<span class="sd">        title of the plot (optional)</span>

<span class="sd">    limits : list/array with two float numbers</span>
<span class="sd">        The z-axis limits [min, max] (optional)</span>

<span class="sd">    ax : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Input argument is not valid.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">):</span>
        <span class="c"># extract matrix data from Qobj</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">xpos</span> <span class="o">=</span> <span class="n">xpos</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">ypos</span> <span class="o">=</span> <span class="n">ypos</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">zpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">limits</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">z_min</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">z_max</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">z_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dz</span><span class="p">)</span>
        <span class="n">z_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dz</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">z_min</span> <span class="o">==</span> <span class="n">z_max</span><span class="p">:</span>
            <span class="n">z_min</span> <span class="o">-=</span> <span class="mf">0.1</span>
            <span class="n">z_max</span> <span class="o">+=</span> <span class="mf">0.1</span>

    <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;jet&#39;</span><span class="p">)</span>  <span class="c"># Spectral</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">dz</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">35</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">bar3d</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">zpos</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">fig</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c"># x axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">w_xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">xlabels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c"># y axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">w_yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ylabels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ylabels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c"># z axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">w_zaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">z_max</span><span class="p">])</span>

    <span class="c"># color axis</span>
    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="matrix_histogram_complex"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.matrix_histogram_complex">[docs]</a><span class="k">def</span> <span class="nf">matrix_histogram_complex</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">xlabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">phase_limits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">threshold</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a histogram for the amplitudes of matrix M, using the argument</span>
<span class="sd">    of each element for coloring the bars, with the given x and y labels</span>
<span class="sd">    and title.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M : Matrix of Qobj</span>
<span class="sd">        The matrix to visualize</span>

<span class="sd">    xlabels : list of strings</span>
<span class="sd">        list of x labels</span>

<span class="sd">    ylabels : list of strings</span>
<span class="sd">        list of y labels</span>

<span class="sd">    title : string</span>
<span class="sd">        title of the plot (optional)</span>

<span class="sd">    limits : list/array with two float numbers</span>
<span class="sd">        The z-axis limits [min, max] (optional)</span>

<span class="sd">    phase_limits : list/array with two float numbers</span>
<span class="sd">        The phase-axis (colorbar) limits [min, max] (optional)</span>

<span class="sd">    ax : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    threshold: float (None)</span>
<span class="sd">        Threshold for when bars of smaller height should be transparent. If</span>
<span class="sd">        not set, all bars are colored according to the color map.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Input argument is not valid.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">):</span>
        <span class="c"># extract matrix data from Qobj</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">xpos</span> <span class="o">=</span> <span class="n">xpos</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">ypos</span> <span class="o">=</span> <span class="n">ypos</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">zpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">Mvec</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span>

    <span class="c"># make small numbers real, to avoid random colors</span>
    <span class="n">idx</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">)</span>
    <span class="n">Mvec</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Mvec</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">phase_limits</span><span class="p">:</span>  <span class="c"># check that limits is a list type</span>
        <span class="n">phase_min</span> <span class="o">=</span> <span class="n">phase_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">phase_max</span> <span class="o">=</span> <span class="n">phase_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">phase_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span>
        <span class="n">phase_max</span> <span class="o">=</span> <span class="n">pi</span>

    <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">phase_min</span><span class="p">,</span> <span class="n">phase_max</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">complex_phase_cmap</span><span class="p">()</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">angle</span><span class="p">(</span><span class="n">Mvec</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">colors</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">dz</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">35</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">bar3d</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">zpos</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">fig</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c"># x axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">w_xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">xlabels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c"># y axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">w_yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">IndexLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ylabels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ylabels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c"># z axis</span>
    <span class="k">if</span> <span class="n">limits</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limits</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c"># use min/max</span>
    <span class="c"># ax.set_zlabel(&#39;abs&#39;)</span>

    <span class="c"># color axis</span>
    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="p">])</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span>
            <span class="p">(</span><span class="s">r&#39;$-\pi$&#39;</span><span class="p">,</span> <span class="s">r&#39;$-\pi/2$&#39;</span><span class="p">,</span> <span class="s">r&#39;$0$&#39;</span><span class="p">,</span> <span class="s">r&#39;$\pi/2$&#39;</span><span class="p">,</span> <span class="s">r&#39;$\pi$&#39;</span><span class="p">))</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;arg&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="plot_energy_levels"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_energy_levels">[docs]</a><span class="k">def</span> <span class="nf">plot_energy_levels</span><span class="p">(</span><span class="n">H_list</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show_ylabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the energy level diagrams for a list of Hamiltonians. Include</span>
<span class="sd">    up to N energy levels. For each element in H_list, the energy</span>
<span class="sd">    levels diagram for the cummulative Hamiltonian sum(H_list[0:n]) is plotted,</span>
<span class="sd">    where n is the index of an element in H_list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">        H_list : List of Qobj</span>
<span class="sd">            A list of Hamiltonians.</span>

<span class="sd">        labels : List of string</span>
<span class="sd">            A list of labels for each Hamiltonian</span>

<span class="sd">        show_ylabels : Bool (default False)</span>
<span class="sd">            Show y labels to the left of energy levels of the initial</span>
<span class="sd">            Hamiltonian.</span>

<span class="sd">        N : int</span>
<span class="sd">            The number of energy levels to plot</span>

<span class="sd">        figsize : tuple (int,int)</span>
<span class="sd">            The size of the figure (width, height).</span>

<span class="sd">        fig : a matplotlib Figure instance</span>
<span class="sd">            The Figure canvas in which the plot will be drawn.</span>

<span class="sd">        ax : a matplotlib axes instance</span>
<span class="sd">            The axes context in which the plot will be drawn.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>

<span class="sd">        ValueError</span>
<span class="sd">            Input argument is not valid.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">H_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;H_list must be a list of Qobj instances&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">H_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">N</span><span class="p">)</span>

    <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yticks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">evals0</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">(</span><span class="n">eigvals</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e_idx</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evals0</span><span class="p">[:</span><span class="n">N</span><span class="p">]):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">e</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">yticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="k">for</span> <span class="n">H1</span> <span class="ow">in</span> <span class="n">H_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>

        <span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H1</span>
        <span class="n">evals1</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e_idx</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evals1</span><span class="p">[:</span><span class="n">N</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">evals0</span><span class="p">[</span><span class="n">e_idx</span><span class="p">],</span> <span class="n">e</span><span class="p">]),</span> <span class="s">&#39;k:&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">e_idx</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evals1</span><span class="p">[:</span><span class="n">N</span><span class="p">]):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">e</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span>

        <span class="n">evals0</span> <span class="o">=</span> <span class="n">evals1</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_ylabels</span><span class="p">:</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">yticks</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<span class="k">def</span> <span class="nf">energy_level_diagram</span><span class="p">(</span><span class="n">H_list</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show_ylabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Deprecated: Use plot_energy_levels&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_energy_levels</span><span class="p">(</span><span class="n">H_list</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                              <span class="n">show_ylabels</span><span class="o">=</span><span class="n">show_ylabels</span><span class="p">,</span>
                              <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>


<div class="viewcode-block" id="plot_fock_distribution"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_fock_distribution">[docs]</a><span class="k">def</span> <span class="nf">plot_fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit_y_range</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the Fock distribution for a density matrix (or ket) that describes</span>
<span class="sd">    an oscillator mode.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : :class:`qutip.qobj.Qobj`</span>
<span class="sd">        The density matrix (or ket) of the state to visualize.</span>

<span class="sd">    fig : a matplotlib Figure instance</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    title : string</span>
<span class="sd">        An optional title for the figure.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isket</span><span class="p">(</span><span class="n">rho</span><span class="p">):</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">diag</span><span class="p">()),</span>
           <span class="n">color</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">unit_y_range</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-.</span><span class="mi">5</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Fock number&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Occupation probability&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<span class="k">def</span> <span class="nf">fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit_y_range</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Deprecated: Use plot_fock_distribution&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                  <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                  <span class="n">unit_y_range</span><span class="o">=</span><span class="n">unit_y_range</span><span class="p">)</span>


<div class="viewcode-block" id="plot_wigner"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_wigner">[docs]</a><span class="k">def</span> <span class="nf">plot_wigner</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">alpha_max</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s">&#39;iterative&#39;</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;2d&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the the Wigner function for a density matrix (or ket) that describes</span>
<span class="sd">    an oscillator mode.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : :class:`qutip.qobj.Qobj`</span>
<span class="sd">        The density matrix (or ket) of the state to visualize.</span>

<span class="sd">    fig : a matplotlib Figure instance</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    cmap : a matplotlib cmap instance</span>
<span class="sd">        The colormap.</span>

<span class="sd">    alpha_max : float</span>
<span class="sd">        The span of the x and y coordinates (both [-alpha_max, alpha_max]).</span>

<span class="sd">    colorbar : bool</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached to the</span>
<span class="sd">        Wigner function graph.</span>

<span class="sd">    method : string {&#39;iterative&#39;, &#39;laguerre&#39;, &#39;fft&#39;}</span>
<span class="sd">        The method used for calculating the wigner function. See the</span>
<span class="sd">        documentation for qutip.wigner for details.</span>

<span class="sd">    projection: string {&#39;2d&#39;, &#39;3d&#39;}</span>
<span class="sd">        Specify whether the Wigner function is to be plotted as a</span>
<span class="sd">        contour graph (&#39;2d&#39;) or surface plot (&#39;3d&#39;).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&#39;2d&#39;</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&#39;3d&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unexpected value of projection keyword argument&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isket</span><span class="p">(</span><span class="n">rho</span><span class="p">):</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

    <span class="n">xvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">alpha_max</span><span class="p">,</span> <span class="n">alpha_max</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">W0</span> <span class="o">=</span> <span class="n">wigner</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="n">W</span><span class="p">,</span> <span class="n">yvec</span> <span class="o">=</span> <span class="n">W0</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">W0</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span> <span class="k">else</span> <span class="p">(</span><span class="n">W0</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

    <span class="n">wlim</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;RdBu&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&#39;2d&#39;</span><span class="p">:</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>
                         <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="o">-</span><span class="n">wlim</span><span class="p">,</span> <span class="n">wlim</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&#39;3d&#39;</span><span class="p">:</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W0</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="o">-</span><span class="n">wlim</span><span class="p">,</span> <span class="n">wlim</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unexpected value of projection keyword argument.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xvec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">yvec</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">xvec</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">xvec</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&#39;$\rm{Re}(\alpha)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&#39;$\rm{Im}(\alpha)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Wigner function&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="plot_wigner_fock_distribution"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_wigner_fock_distribution">[docs]</a><span class="k">def</span> <span class="nf">plot_wigner_fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                  <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">alpha_max</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                  <span class="n">method</span><span class="o">=</span><span class="s">&#39;iterative&#39;</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;2d&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the Fock distribution and the Wigner function for a density matrix</span>
<span class="sd">    (or ket) that describes an oscillator mode.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : :class:`qutip.qobj.Qobj`</span>
<span class="sd">        The density matrix (or ket) of the state to visualize.</span>

<span class="sd">    fig : a matplotlib Figure instance</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    axes : a list of two matplotlib axes instances</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    cmap : a matplotlib cmap instance</span>
<span class="sd">        The colormap.</span>

<span class="sd">    alpha_max : float</span>
<span class="sd">        The span of the x and y coordinates (both [-alpha_max, alpha_max]).</span>

<span class="sd">    colorbar : bool</span>
<span class="sd">        Whether (True) or not (False) a colorbar should be attached to the</span>
<span class="sd">        Wigner function graph.</span>

<span class="sd">    method : string {&#39;iterative&#39;, &#39;laguerre&#39;, &#39;fft&#39;}</span>
<span class="sd">        The method used for calculating the wigner function. See the</span>
<span class="sd">        documentation for qutip.wigner for details.</span>

<span class="sd">    projection: string {&#39;2d&#39;, &#39;3d&#39;}</span>
<span class="sd">        Specify whether the Wigner function is to be plotted as a</span>
<span class="sd">        contour graph (&#39;2d&#39;) or surface plot (&#39;3d&#39;).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">axes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&#39;2d&#39;</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s">&#39;3d&#39;</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;3d&#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unexpected value of projection keyword argument&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isket</span><span class="p">(</span><span class="n">rho</span><span class="p">):</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">ket2dm</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

    <span class="n">plot_fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plot_wigner</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                <span class="n">alpha_max</span><span class="o">=</span><span class="n">alpha_max</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>

</div>
<span class="k">def</span> <span class="nf">wigner_fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                             <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">alpha_max</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                             <span class="n">method</span><span class="o">=</span><span class="s">&#39;iterative&#39;</span><span class="p">):</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Deprecated: Use plot_wigner_fock_distribution&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_wigner_fock_distribution</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span>
                                         <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                         <span class="n">alpha_max</span><span class="o">=</span><span class="n">alpha_max</span><span class="p">,</span>
                                         <span class="n">colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span>
                                         <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>


<div class="viewcode-block" id="plot_expectation_values"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_expectation_values">[docs]</a><span class="k">def</span> <span class="nf">plot_expectation_values</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">ylabels</span><span class="o">=</span><span class="p">[],</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize the results (expectation values) for an evolution solver.</span>
<span class="sd">    `results` is assumed to be an instance of Result, or a list of Result</span>
<span class="sd">    instances.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results : (list of) :class:`qutip.solver.Result`</span>
<span class="sd">        List of results objects returned by any of the QuTiP evolution solvers.</span>

<span class="sd">    ylabels : list of strings</span>
<span class="sd">        The y-axis labels. List should be of the same length as `results`.</span>

<span class="sd">    title : string</span>
<span class="sd">        The title of the figure.</span>

<span class="sd">    show_legend : bool</span>
<span class="sd">        Whether or not to show the legend.</span>

<span class="sd">    fig : a matplotlib Figure instance</span>
<span class="sd">        The Figure canvas in which the plot will be drawn.</span>

<span class="sd">    axes : a matplotlib axes instance</span>
<span class="sd">        The axes context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="p">]</span>

    <span class="n">n_e_ops</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">axes</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">figsize</span><span class="p">:</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n_e_ops</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_e_ops</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                 <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">r_idx</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">e_idx</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">):</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">e_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> [</span><span class="si">%d</span><span class="s">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">solver</span><span class="p">,</span> <span class="n">e_idx</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="n">n_e_ops</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_e_ops</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">show_legend</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ylabels</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabels</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>

</div>
<div class="viewcode-block" id="plot_spin_distribution_2d"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_spin_distribution_2d">[docs]</a><span class="k">def</span> <span class="nf">plot_spin_distribution_2d</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="n">PHI</span><span class="p">,</span>
                              <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a spin distribution function (given as meshgrid data) with a 2D</span>
<span class="sd">    projection where the surface of the unit sphere is mapped on the unit disk.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    P : matrix</span>
<span class="sd">        Distribution values as a meshgrid matrix.</span>

<span class="sd">    THETA : matrix</span>
<span class="sd">        Meshgrid matrix for the theta coordinate.</span>

<span class="sd">    PHI : matrix</span>
<span class="sd">        Meshgrid matrix for the phi coordinate.</span>

<span class="sd">    fig : a matplotlib figure instance</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">figsize</span><span class="p">:</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">THETA</span> <span class="o">-</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">pi</span> <span class="o">-</span> <span class="n">PHI</span><span class="p">)</span> <span class="o">/</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA</span> <span class="o">-</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1e12</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&#39;$\varphi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&#39;$\theta$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s">r&#39;$0$&#39;</span><span class="p">,</span> <span class="s">r&#39;$\pi$&#39;</span><span class="p">,</span> <span class="s">r&#39;$2\pi$&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">r&#39;$\pi$&#39;</span><span class="p">,</span> <span class="s">r&#39;$\pi/2$&#39;</span><span class="p">,</span> <span class="s">r&#39;$0$&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="plot_spin_distribution_3d"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_spin_distribution_3d">[docs]</a><span class="k">def</span> <span class="nf">plot_spin_distribution_3d</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="n">PHI</span><span class="p">,</span>
                              <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Plots a matrix of values on a sphere</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    P : matrix</span>
<span class="sd">        Distribution values as a meshgrid matrix.</span>

<span class="sd">    THETA : matrix</span>
<span class="sd">        Meshgrid matrix for the theta coordinate.</span>

<span class="sd">    PHI : matrix</span>
<span class="sd">        Meshgrid matrix for the phi coordinate.</span>

<span class="sd">    fig : a matplotlib figure instance</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">azim</span><span class="o">=-</span><span class="mi">35</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>

    <span class="n">xx</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
    <span class="n">zz</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1e12</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">P</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">P</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">facecolors</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">P</span><span class="p">)),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">cax</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=.</span><span class="mi">66</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mo">02</span><span class="p">)</span>
    <span class="n">cb1</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">cb1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;magnitude&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


<span class="c">#</span>
<span class="c"># Qubism and other qubistic visualizations</span>
<span class="c">#</span></div>
<span class="k">def</span> <span class="nf">complex_array_to_rgb</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s">&#39;light&#39;</span><span class="p">,</span> <span class="n">rmax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes an array of complex number and converts it to an array of [r, g, b],</span>
<span class="sd">    where phase gives hue and saturation/value are given by the absolute value.</span>
<span class="sd">    Especially for use with imshow for complex plots.</span>

<span class="sd">    For more info on coloring, see:</span>
<span class="sd">        Emilia Petrisor,</span>
<span class="sd">        Visualizing complex-valued functions with Matplotlib and Mayavi</span>
<span class="sd">        http://nbviewer.ipython.org/github/empet/Math/blob/master/DomainColoring.ipynb</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array</span>
<span class="sd">        Array (of any dimension) of complex numbers.</span>

<span class="sd">    theme : &#39;light&#39; (default) or &#39;dark&#39;</span>
<span class="sd">        Set coloring theme for mapping complex values into colors.</span>

<span class="sd">    rmax : float</span>
<span class="sd">        Maximal abs value for color normalization.</span>
<span class="sd">        If None (default), uses np.abs(X).max().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Y : array</span>
<span class="sd">        Array of colors (of shape X.shape + (3,)).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">absmax</span> <span class="o">=</span> <span class="n">rmax</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">absmax</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">absmax</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
    <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">theme</span> <span class="o">==</span> <span class="s">&#39;light&#39;</span><span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">absmax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">theme</span> <span class="o">==</span> <span class="s">&#39;dark&#39;</span><span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Y</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">absmax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">hsv_to_rgb</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Y</span>


<span class="k">def</span> <span class="nf">_index_to_sequence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For a matrix entry with index i it returns state it corresponds to.</span>
<span class="sd">    In particular, for dim_list=[2]*n it returns i written as a binary number.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    i : int</span>
<span class="sd">        Index in a matrix.</span>

<span class="sd">    dim_list : list of int</span>
<span class="sd">        List of dimensions of consecutive particles.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    seq : list</span>
<span class="sd">        List of coordinates for each particle.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">dim_list</span><span class="p">):</span>
        <span class="n">j</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_sequence_to_index</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">dim_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inverse of _index_to_sequence.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    seq : list of ints</span>
<span class="sd">        List of coordinates for each particle.</span>

<span class="sd">    dim_list : list of int</span>
<span class="sd">        List of dimensions of consecutive particles.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    i : list</span>
<span class="sd">        Index in a matrix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">dim_list</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">*=</span> <span class="n">d</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="n">s</span>

    <span class="k">return</span> <span class="n">i</span>


<span class="k">def</span> <span class="nf">_to_qubism_index_pair</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim_list</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;pairs&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For a matrix entry with index i</span>
<span class="sd">    it returns x, y coordinates in qubism mapping.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    i : int</span>
<span class="sd">        Index in a matrix.</span>

<span class="sd">    dim_list : list of int</span>
<span class="sd">        List of dimensions of consecutive particles.</span>

<span class="sd">    how : &#39;pairs&#39; (&#39;default&#39;), &#39;pairs_skewed&#39; or &#39;before_after&#39;</span>
<span class="sd">        Type of qubistic plot.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x, y : tuple of ints</span>
<span class="sd">        List of coordinates for each particle.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="n">_index_to_sequence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim_list</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;pairs&#39;</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_sequence_to_index</span><span class="p">(</span><span class="n">seq</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">dim_list</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">_sequence_to_index</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">dim_list</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;pairs_skewed&#39;</span><span class="p">:</span>
        <span class="n">dim_list2</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_sequence_to_index</span><span class="p">(</span><span class="n">seq</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">dim_list2</span><span class="p">)</span>
        <span class="n">seq2</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">seq</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">dim_list2</span><span class="p">)]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">_sequence_to_index</span><span class="p">(</span><span class="n">seq2</span><span class="p">,</span> <span class="n">dim_list2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;before_after&#39;</span><span class="p">:</span>
        <span class="c"># https://en.wikipedia.org/wiki/File:Ising-tartan.png</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dim_list</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_sequence_to_index</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">seq</span><span class="p">[:(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]),</span>
                               <span class="nb">reversed</span><span class="p">(</span><span class="n">dim_list</span><span class="p">[:(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">_sequence_to_index</span><span class="p">(</span><span class="n">seq</span><span class="p">[(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):],</span> <span class="n">dim_list</span><span class="p">[(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No such &#39;how&#39;.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">_sequence_to_latex</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">&#39;ket&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For a sequence of particle states generate LaTeX code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    seq : list of ints</span>
<span class="sd">        List of coordinates for each particle.</span>

<span class="sd">    style : &#39;ket&#39; (default), &#39;bra&#39; or &#39;bare&#39;</span>
<span class="sd">        Style of LaTeX (i.e. |01&gt; or &lt;01| or 01, respectively).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    latex : str</span>
<span class="sd">        LaTeX output.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&#39;ket&#39;</span><span class="p">:</span>
        <span class="n">latex</span> <span class="o">=</span> <span class="s">&quot;$</span><span class="se">\\</span><span class="s">left|{0}</span><span class="se">\\</span><span class="s">right</span><span class="se">\\</span><span class="s">rangle$&quot;</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&#39;bra&#39;</span><span class="p">:</span>
        <span class="n">latex</span> <span class="o">=</span> <span class="s">&quot;$</span><span class="se">\\</span><span class="s">left</span><span class="se">\\</span><span class="s">langle{0}</span><span class="se">\\</span><span class="s">right|$&quot;</span>
    <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s">&#39;bare&#39;</span><span class="p">:</span>
        <span class="n">latex</span> <span class="o">=</span> <span class="s">&quot;${0}$&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No such style.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">latex</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">seq</span><span class="p">)))</span>


<div class="viewcode-block" id="plot_qubism"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_qubism">[docs]</a><span class="k">def</span> <span class="nf">plot_qubism</span><span class="p">(</span><span class="n">ket</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s">&#39;light&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;pairs&#39;</span><span class="p">,</span>
                <span class="n">grid_iteration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">legend_iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Qubism plot for pure states of many qudits.</span>
<span class="sd">    Works best for spin chains, especially with even number of particles</span>
<span class="sd">    of the same dimension.</span>
<span class="sd">    Allows to see entanglement between first 2*k particles and the rest.</span>

<span class="sd">    More information:</span>
<span class="sd">        J. Rodriguez-Laguna, P. Migdal,</span>
<span class="sd">        M. Ibanez Berganza, M. Lewenstein, G. Sierra,</span>
<span class="sd">        &quot;Qubism: self-similar visualization of many-body wavefunctions&quot;,</span>
<span class="sd">        New J. Phys. 14 053028 (2012), arXiv:1112.3560,</span>
<span class="sd">        http://dx.doi.org/10.1088/1367-2630/14/5/053028 (open access)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ket : Qobj</span>
<span class="sd">        Pure state for plotting.</span>

<span class="sd">    theme : &#39;light&#39; (default) or &#39;dark&#39;</span>
<span class="sd">        Set coloring theme for mapping complex values into colors.</span>
<span class="sd">        See: complex_array_to_rgb.</span>

<span class="sd">    how : &#39;pairs&#39; (default), &#39;pairs_skewed&#39; or &#39;before_after&#39;</span>
<span class="sd">        Type of Qubism plotting.</span>
<span class="sd">        Options:</span>
<span class="sd">            &#39;pairs&#39; - typical coordinates,</span>
<span class="sd">            &#39;pairs_skewed&#39; - for ferromagnetic/antriferromagnetic plots,</span>
<span class="sd">            &#39;before_after&#39; - related to Schmidt plot (see also: plot_schmidt).</span>

<span class="sd">    grid_iteration : int (default 1)</span>
<span class="sd">        Helper lines to be drawn on plot.</span>
<span class="sd">        Show tiles for 2*grid_iteration particles vs all others.</span>

<span class="sd">    legend_iteration : int (default 0) or &#39;grid_iteration&#39; or &#39;all&#39;</span>
<span class="sd">        Show labels for first 2*legend_iteration particles.</span>
<span class="sd">        Option &#39;grid_iteration&#39; sets the same number of particles</span>
<span class="sd">            as for grid_iteration.</span>
<span class="sd">        Option &#39;all&#39; makes label for all particles.</span>
<span class="sd">        Typically it should be 0, 1, 2 or perhaps 3.</span>

<span class="sd">    fig : a matplotlib figure instance</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">isket</span><span class="p">(</span><span class="n">ket</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Qubism works only for pure states, i.e. kets.&quot;</span><span class="p">)</span>
        <span class="c"># add for dm? (perhaps a separate function, plot_qubism_dm)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">dim_list</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dim_list</span><span class="p">)</span>

    <span class="c"># for odd number of particles - pixels are rectangular</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ket</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">ket</span><span class="p">,</span> <span class="n">Qobj</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">dim_list</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">ketdata</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;pairs&#39;</span><span class="p">:</span>
        <span class="n">dim_list_y</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dim_list_x</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;pairs_skewed&#39;</span><span class="p">:</span>
        <span class="n">dim_list_y</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dim_list_x</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dim_list_x</span> <span class="o">!=</span> <span class="n">dim_list_y</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;For &#39;pairs_skewed&#39; pairs &quot;</span> <span class="o">+</span>
                            <span class="s">&quot;of dimensions need to be the same.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;before_after&#39;</span><span class="p">:</span>
        <span class="n">dim_list_y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">dim_list</span><span class="p">[:(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]))</span>
        <span class="n">dim_list_x</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No such &#39;how&#39;.&quot;</span><span class="p">)</span>

    <span class="n">size_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_x</span><span class="p">)</span>
    <span class="n">size_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_y</span><span class="p">)</span>

    <span class="n">qub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">size_x</span><span class="p">,</span> <span class="n">size_y</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ketdata</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qub</span><span class="p">[</span><span class="n">_to_qubism_index_pair</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim_list</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ketdata</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">qub</span> <span class="o">=</span> <span class="n">qub</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="n">quadrants_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_x</span><span class="p">[:</span><span class="n">grid_iteration</span><span class="p">])</span>
    <span class="n">quadrants_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_y</span><span class="p">[:</span><span class="n">grid_iteration</span><span class="p">])</span>

    <span class="n">ticks_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">size_x</span> <span class="o">//</span> <span class="n">quadrants_x</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">quadrants_x</span><span class="p">)]</span>
    <span class="n">ticks_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">size_y</span> <span class="o">//</span> <span class="n">quadrants_y</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">quadrants_y</span><span class="p">)]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks_x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">quadrants_x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks_y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">quadrants_y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">theme2color_of_lines</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;light&#39;</span><span class="p">:</span> <span class="s">&#39;#000000&#39;</span><span class="p">,</span>
                            <span class="s">&#39;dark&#39;</span><span class="p">:</span> <span class="s">&#39;#FFFFFF&#39;</span><span class="p">}</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">theme2color_of_lines</span><span class="p">[</span><span class="n">theme</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">complex_array_to_rgb</span><span class="p">(</span><span class="n">qub</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">),</span>
              <span class="n">interpolation</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">,</span>
              <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size_y</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">legend_iteration</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">label_n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">legend_iteration</span> <span class="o">==</span> <span class="s">&#39;grid_iteration&#39;</span><span class="p">:</span>
        <span class="n">label_n</span> <span class="o">=</span> <span class="n">grid_iteration</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">label_n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">legend_iteration</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No such option for legend_iteration keyword &quot;</span> <span class="o">+</span>
                            <span class="s">&quot;argument. Use &#39;all&#39;, &#39;grid_iteration&#39; or an &quot;</span> <span class="o">+</span>
                            <span class="s">&quot;integer.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label_n</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s">&#39;before_after&#39;</span><span class="p">:</span>
            <span class="n">dim_list_small</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">dim_list_y</span><span class="p">[</span><span class="o">-</span><span class="n">label_n</span><span class="p">:]))</span> \
                <span class="o">+</span> <span class="n">dim_list_x</span><span class="p">[:</span><span class="n">label_n</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim_list_small</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">label_n</span><span class="p">):</span>
                <span class="n">dim_list_small</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dim_list_y</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">dim_list_small</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dim_list_x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="n">scale_x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">size_x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_x</span><span class="p">[:</span><span class="n">label_n</span><span class="p">])</span>
        <span class="n">shift_x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">scale_x</span>
        <span class="n">scale_y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">size_y</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_y</span><span class="p">[:</span><span class="n">label_n</span><span class="p">])</span>
        <span class="n">shift_y</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">scale_y</span>

        <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">35</span> <span class="o">*</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_x</span><span class="p">[:</span><span class="n">label_n</span><span class="p">])</span> <span class="o">/</span> <span class="n">label_n</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;fontsize&#39;</span><span class="p">:</span> <span class="n">fontsize</span><span class="p">,</span>
                <span class="s">&#39;color&#39;</span><span class="p">:</span> <span class="n">theme2color_of_lines</span><span class="p">[</span><span class="n">theme</span><span class="p">],</span>
                <span class="s">&#39;horizontalalignment&#39;</span><span class="p">:</span> <span class="s">&#39;center&#39;</span><span class="p">,</span>
                <span class="s">&#39;verticalalignment&#39;</span><span class="p">:</span> <span class="s">&#39;center&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_small</span><span class="p">)):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_to_qubism_index_pair</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim_list_small</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="n">_index_to_sequence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim_list</span><span class="o">=</span><span class="n">dim_list_small</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">scale_x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">shift_x</span><span class="p">,</span>
                    <span class="n">size_y</span> <span class="o">-</span> <span class="p">(</span><span class="n">scale_y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">shift_y</span><span class="p">),</span>
                    <span class="n">_sequence_to_latex</span><span class="p">(</span><span class="n">seq</span><span class="p">),</span>
                    <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="plot_schmidt"><a class="viewcode-back" href="../../apidoc/functions.html#qutip.visualization.plot_schmidt">[docs]</a><span class="k">def</span> <span class="nf">plot_schmidt</span><span class="p">(</span><span class="n">ket</span><span class="p">,</span> <span class="n">splitting</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">labels_iteration</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                 <span class="n">theme</span><span class="o">=</span><span class="s">&#39;light&#39;</span><span class="p">,</span>
                 <span class="n">fig</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plotting scheme related to Schmidt decomposition.</span>
<span class="sd">    Converts a state into a matrix (A_ij -&gt; A_i^j),</span>
<span class="sd">    where rows are first particles and columns - last.</span>

<span class="sd">    See also: plot_qubism with how=&#39;before_after&#39; for a similar plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ket : Qobj</span>
<span class="sd">        Pure state for plotting.</span>

<span class="sd">    splitting : int</span>
<span class="sd">        Plot for a number of first particles versus the rest.</span>
<span class="sd">        If not given, it is (number of particles + 1) // 2.</span>

<span class="sd">    theme : &#39;light&#39; (default) or &#39;dark&#39;</span>
<span class="sd">        Set coloring theme for mapping complex values into colors.</span>
<span class="sd">        See: complex_array_to_rgb.</span>

<span class="sd">    labels_iteration : int or pair of ints (default (3,2))</span>
<span class="sd">        Number of particles to be shown as tick labels,</span>
<span class="sd">        for first (vertical) and last (horizontal) particles, respectively.</span>

<span class="sd">    fig : a matplotlib figure instance</span>
<span class="sd">        The figure canvas on which the plot will be drawn.</span>

<span class="sd">    ax : a matplotlib axis instance</span>
<span class="sd">        The axis context in which the plot will be drawn.</span>

<span class="sd">    figsize : (width, height)</span>
<span class="sd">        The size of the matplotlib figure (in inches) if it is to be created</span>
<span class="sd">        (that is, if no &#39;fig&#39; and &#39;ax&#39; arguments are passed).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, ax : tuple</span>
<span class="sd">        A tuple of the matplotlib figure and axes instances used to produce</span>
<span class="sd">        the figure.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isket</span><span class="p">(</span><span class="n">ket</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Schmidt plot works only for pure states, i.e. kets.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">dim_list</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">splitting</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">splitting</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dim_list</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels_iteration</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">labels_iteration</span> <span class="o">=</span> <span class="n">labels_iteration</span><span class="p">,</span> <span class="n">labels_iteration</span>

    <span class="n">ketdata</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>

    <span class="n">dim_list_y</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[:</span><span class="n">splitting</span><span class="p">]</span>
    <span class="n">dim_list_x</span> <span class="o">=</span> <span class="n">dim_list</span><span class="p">[</span><span class="n">splitting</span><span class="p">:]</span>

    <span class="n">size_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_x</span><span class="p">)</span>
    <span class="n">size_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_y</span><span class="p">)</span>

    <span class="n">ketdata</span> <span class="o">=</span> <span class="n">ketdata</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">size_y</span><span class="p">,</span> <span class="n">size_x</span><span class="p">))</span>

    <span class="n">dim_list_small_x</span> <span class="o">=</span> <span class="n">dim_list_x</span><span class="p">[:</span><span class="n">labels_iteration</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">dim_list_small_y</span> <span class="o">=</span> <span class="n">dim_list_y</span><span class="p">[:</span><span class="n">labels_iteration</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="n">quadrants_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_small_x</span><span class="p">)</span>
    <span class="n">quadrants_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim_list_small_y</span><span class="p">)</span>

    <span class="n">ticks_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">size_x</span> <span class="o">/</span> <span class="n">quadrants_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">quadrants_x</span><span class="p">)]</span>
    <span class="n">ticks_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">size_y</span> <span class="o">/</span> <span class="n">quadrants_y</span> <span class="o">*</span> <span class="p">(</span><span class="n">quadrants_y</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">quadrants_y</span><span class="p">)]</span>

    <span class="n">labels_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sequence_to_latex</span><span class="p">(</span><span class="n">_index_to_sequence</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">size_x</span> <span class="o">//</span> <span class="n">quadrants_x</span><span class="p">,</span>
                                                      <span class="n">dim_list</span><span class="o">=</span><span class="n">dim_list_x</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">quadrants_x</span><span class="p">)]</span>
    <span class="n">labels_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sequence_to_latex</span><span class="p">(</span><span class="n">_index_to_sequence</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">size_y</span> <span class="o">//</span> <span class="n">quadrants_y</span><span class="p">,</span>
                                                      <span class="n">dim_list</span><span class="o">=</span><span class="n">dim_list_y</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">quadrants_y</span><span class="p">)]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks_x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels_x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks_y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels_y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;last particles&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;first particles&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">complex_array_to_rgb</span><span class="p">(</span><span class="n">ketdata</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">),</span>
              <span class="n">interpolation</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">,</span>
              <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size_y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011 and later, P.D. Nation, J.R. Johansson.<br/>
      Last updated on Dec 31, 2014.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>