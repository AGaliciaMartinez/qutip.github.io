
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Solving for Steady-State Solutions &mdash; QuTiP 3.1.0 Documentation</title>
    
    <link rel="stylesheet" href="../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/bootswatch-3.2.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../static/site.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="top" title="QuTiP 3.1.0 Documentation" href="../index.html" />
    <link rel="up" title="Users Guide" href="guide.html" />
    <link rel="next" title="An Overview of the Eseries Class" href="guide-eseries.html" />
    <link rel="prev" title="Setting Options for the Dynamics Solvers" href="dynamics/dynamics-options.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          QuTiP</a>
        <span class="navbar-text navbar-version pull-left"><b>3.1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="http://qutip.org">qutip.org</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Docs <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter.html">Frontmatter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#about-this-documentation">About This Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#citing-this-project">Citing This Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#funding">Funding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#about-qutip">About QuTiP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#contributing-to-qutip">Contributing to QuTiP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#general-requirements">General Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#platform-independent-installation">Platform-independent installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#get-the-source-code">Get the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-from-source">Installing from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-on-ubuntu-linux">Installation on Ubuntu Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-on-mac-os-x-10-8">Installation on Mac OS X (10.8+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-on-windows">Installation on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#optional-installation-options">Optional Installation Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#verifying-the-installation">Verifying the Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#checking-version-information-using-the-about-function">Checking Version Information using the About Function</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="guide.html">Users Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="guide-overview.html">Guide Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-basics.html">Basic Operations on Quantum Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-states.html">Manipulating States and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-tensor.html">Using Tensor Products and Partial Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-dynamics.html">Time Evolution and Quantum System Dynamics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Solving for Steady-State Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-eseries.html">An Overview of the Eseries Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-correlation.html">Two-time correlation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-bloch.html">Plotting on the Bloch Sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-visualization.html">Visualization of quantum states and processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-parfor.html">Parallel computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-saving.html">Saving QuTiP Objects and Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-random.html">Generating Random Quantum States &amp; Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-settings.html">Modifying Internal QuTiP Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/apidoc.html">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/classes.html">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/functions.html">Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-3-1-0-january-1-2015">Version 3.1.0 (January 1, 2015):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-3-0-1-aug-5-2014">Version 3.0.1 (Aug 5, 2014):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-3-0-0-july-17-2014">Version 3.0.0 (July 17, 2014):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-2-0-march-01-2013">Version 2.2.0 (March 01, 2013):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-1-0-october-05-2012">Version 2.1.0 (October 05, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-0-0-june-01-2012">Version 2.0.0 (June 01, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-4-may-28-2012">Version 1.1.4 (May 28, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-3-november-21-2011">Version 1.1.3 (November 21, 2011):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-2-october-27-2011">Version 1.1.2 (October 27, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-1-october-25-2011">Version 1.1.1 (October 25, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-0-october-04-2011">Version 1.1.0 (October 04, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-0-july-29-2011">Version 1.0.0 (July 29, 2011)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Developers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributors.html#lead-developers">Lead Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../biblio.html">Bibliography</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Solving for Steady-State Solutions</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#steady-state-solutions-for-arbitrary-systems">Steady State Solutions for Arbitrary Systems</a></li>
<li><a class="reference internal" href="#steady-state-solvers-in-qutip">Steady State solvers in QuTiP</a></li>
<li><a class="reference internal" href="#using-the-steadystate-solver">Using the Steadystate Solver</a></li>
<li><a class="reference internal" href="#additional-solver-arguments">Additional Solver Arguments</a></li>
<li><a class="reference internal" href="#example-harmonic-oscillator-in-thermal-bath">Example: Harmonic Oscillator in Thermal Bath</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="dynamics/dynamics-options.html" title="Previous Chapter: Setting Options for the Dynamics Solvers"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Setting Options ...</span>
    </a>
  </li>
  <li>
    <a href="guide-eseries.html" title="Next Chapter: An Overview of the Eseries Class"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">An Overview of t... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="solving-for-steady-state-solutions">
<span id="steady"></span><h1>Solving for Steady-State Solutions<a class="headerlink" href="#solving-for-steady-state-solutions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="steady-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>For time-independent open quantum systems with decay rates larger than the corresponding excitation rates, the system will tend toward a steady state as <span class="math">\(t\rightarrow\infty\)</span> that satisfies the equation</p>
<div class="math">
\[\frac{d\hat{\rho}_{ss}}{dt}=\mathcal{L}\hat{\rho}_{ss}=0.\]</div>
<p>Although the requirement for time-independence seems quite resitrictive, one can often employ a transformation to the interaction picture that yields a time-independent Hamiltonian.  For many these systems, solving for the asymptotic density matrix <span class="math">\(\hat{\rho}_{ss}\)</span> can be achieved using direct or iterative solution methods faster than using master equation or Monte Carlo simulations.  Although the steady state equation has a simple mathematical form, the properties of the Liouvillian operator are such that the solutions to this equation are anything but straightforward to find.</p>
</div>
<div class="section" id="steady-state-solutions-for-arbitrary-systems">
<h2>Steady State Solutions for Arbitrary Systems<a class="headerlink" href="#steady-state-solutions-for-arbitrary-systems" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="steady-state-solvers-in-qutip">
<h2>Steady State solvers in QuTiP<a class="headerlink" href="#steady-state-solvers-in-qutip" title="Permalink to this headline">¶</a></h2>
<p>In QuTiP, the steady-state solution for a system Hamiltonian or Liouvillian is given by <a class="reference internal" href="../apidoc/functions.html#qutip.steadystate.steadystate" title="qutip.steadystate.steadystate"><tt class="xref py py-func docutils literal"><span class="pre">qutip.steadystate.steadystate</span></tt></a>.  This function implements a number of different methods for finding the steady state, each with their own pros and cons, where the method used can be chosen using the <tt class="docutils literal"><span class="pre">method</span></tt> keyword argument.</p>
<p>Available Steady-State Methods:</p>
<table border="1" class="table-striped docutils">
<colgroup>
<col width="18%" />
<col width="27%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Keyword</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Direct (default)</td>
<td>&#8216;direct&#8217;</td>
<td>Direct solution solving <span class="math">\(Ax=b\)</span> via sparse LU decomposition.</td>
</tr>
<tr class="row-odd"><td>Eigenvalue</td>
<td>&#8216;eigen&#8217;</td>
<td>Iteratively find the eigenvector corresponding to the zero eigenvalue of <span class="math">\(\mathcal{L}\)</span>.</td>
</tr>
<tr class="row-even"><td>Inverse-Power</td>
<td>&#8216;power&#8217;</td>
<td>Iteratively solve for the steady-state solution using the inverse-power method.</td>
</tr>
<tr class="row-odd"><td>GMRES</td>
<td>&#8216;iterative-gmres&#8217;</td>
<td>Iteratively solve for the steady-state solution using the GMRES method and optional preconditioner.</td>
</tr>
<tr class="row-even"><td>LGMRES</td>
<td>&#8216;iterative-lgmres&#8217;</td>
<td>Iteratively solve for the steady-state solution using the LGMRES method and optional preconditioner.</td>
</tr>
<tr class="row-odd"><td>BICGSTAB</td>
<td>&#8216;iterative-bicgstab&#8217;</td>
<td>Iteratively solve for the steady-state solution using the BICGSTAB method and optional preconditioner.</td>
</tr>
<tr class="row-even"><td>SVD</td>
<td>&#8216;svd&#8217;</td>
<td>Steady-state solution via the SVD of the Liouvillian represented by a <strong>dense</strong> matrix.</td>
</tr>
</tbody>
</table>
<p>The function <a class="reference internal" href="../apidoc/functions.html#qutip.steadystate.steadystate" title="qutip.steadystate.steadystate"><tt class="xref py py-func docutils literal"><span class="pre">qutip.steadystate.steadystate</span></tt></a> can take either a Hamiltonian and a list of collapse operators as input, generating internally the corresponding Liouvillian super operator in Lindblad form, or alternatively, an arbitrary Liouvillian passed by the user. When possible, we recommend passing the Hamiltonian and collapse operators to <a class="reference internal" href="../apidoc/functions.html#qutip.steadystate.steadystate" title="qutip.steadystate.steadystate"><tt class="xref py py-func docutils literal"><span class="pre">qutip.steadystate.steadystate</span></tt></a>, and letting the function automatically build the Liouvillian for the system.</p>
</div>
<div class="section" id="using-the-steadystate-solver">
<span id="steady-usage"></span><h2>Using the Steadystate Solver<a class="headerlink" href="#using-the-steadystate-solver" title="Permalink to this headline">¶</a></h2>
<p>Solving for the steady state solution to the Lindblad master equation for a general system with <a class="reference internal" href="../apidoc/functions.html#qutip.steadystate.steadystate" title="qutip.steadystate.steadystate"><tt class="xref py py-func docutils literal"><span class="pre">qutip.steadystate.steadystate</span></tt></a> can be accomplished using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rho_ss</span> <span class="o">=</span> <span class="n">steadystate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c_ops</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">H</span></tt> is a quantum object representing the system Hamiltonian, and <tt class="docutils literal"><span class="pre">c_ops</span></tt> is a list of quantum objects for the system collapse operators. The output, labeled as <tt class="docutils literal"><span class="pre">rho_ss</span></tt>, is the steady-state solution for the systems.  If no other keywords are passed to the solver, the default &#8216;direct&#8217; method is used, generating a solution that is exact to machine precision at the expense of a large memory requirement.  The large amount of memory need for the direct LU decomposition method stems from the large bandwidth of the system Liouvillian and the correspondingly large fill-in (extra nonzero elements) generated in the LU factors.  This fill-in can be reduced by using bandwidth minimization algorithms such as those discussed in <a class="reference internal" href="#steady-args"><em>Additional Solver Arguments</em></a>.  Additional parameters may be used by calling the steady-state solver as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rho_ss</span> <span class="o">=</span> <span class="n">steadystate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c_ops</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;power&#39;</span><span class="p">,</span> <span class="n">use_rcm</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">method='power'</span></tt> indicates that we are using the inverse-power solution method, and <tt class="docutils literal"><span class="pre">use_rcm=True</span></tt> turns on the bandwidth minimization routine.</p>
<p>Although it is not obvious, the <tt class="docutils literal"><span class="pre">'direct'</span></tt>, <tt class="docutils literal"><span class="pre">eigen</span></tt>, and <tt class="docutils literal"><span class="pre">'power'</span></tt> methods all use an LU decomposition internally and thus suffer from a large memory overhead.  In contrast, iterative methods such as the <tt class="docutils literal"><span class="pre">'iterative-gmres'</span></tt>, <tt class="docutils literal"><span class="pre">'iterative-lgmres'</span></tt>, and <tt class="docutils literal"><span class="pre">'iterative-bicgstab'</span></tt> methods do not factor the matrix and thus take less memory than these previous methods and allowing, in principle, for extremely large system sizes. The downside is that these methods can take much longer than the direct method as the condition number of the Liouvillian matrix is large, indicating that these iterative methods require a large number of iterations for convergence.  To overcome this, one can use a preconditioner <span class="math">\(M\)</span> that solves for an approximate inverse for the (modified) Liouvillian, thus better conditioning the problem, leading to faster convergence.  The use of a preconditioner can actually make these iterative methods faster than the other solution methods.  The problem with precondioning is that it is only well defined for Hermitian matrices.  Since the Liouvillian is non-Hermitian, the ability to find a good preconditioner is not guaranteed.  And moreover, if a preconditioner is found, it is not guaranteed to have a good condition number. QuTiP can make use of an incomplete LU preconditioner when using the iterative <tt class="docutils literal"><span class="pre">'gmres'</span></tt>, <tt class="docutils literal"><span class="pre">'lgmres'</span></tt>, and <tt class="docutils literal"><span class="pre">'bicgstab'</span></tt> solvers by setting <tt class="docutils literal"><span class="pre">use_precond=True</span></tt>. The preconditioner optionally makes use of a combination of symmetric and anti-symmetric matrix permutations that attempt to improve the preconditioning process.  These features are discussed in the <a class="reference internal" href="#steady-args"><em>Additional Solver Arguments</em></a> section.  Even with these state-of-the-art permutations, the generation of a successful preconditoner for non-symmetric matrices is currently a trial-and-error process due to the lack of mathematical work done in this area.  It is always recommended to begin with the direct solver with no additional arguments before selecting a different method.</p>
<p>Finding the steady-state solution is not limited to the Lindblad form of the master equation. Any time-independent Liouvillian constructed from a Hamiltonian and collapse operators can be used as an input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rho_ss</span> <span class="o">=</span> <span class="n">steadystate</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">L</span></tt> is the Louvillian.  All of the additional arguments can also be used in this case.</p>
</div>
<div class="section" id="additional-solver-arguments">
<span id="steady-args"></span><h2>Additional Solver Arguments<a class="headerlink" href="#additional-solver-arguments" title="Permalink to this headline">¶</a></h2>
<p>The following additional solver arguments are available for the steady-state solver:</p>
<table border="1" class="table-striped docutils">
<colgroup>
<col width="11%" />
<col width="33%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Options (default listed first)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>method</td>
<td>&#8216;direct&#8217;, &#8216;eigen&#8217;, &#8216;power&#8217;, &#8216;iterative-gmres&#8217;,&#8217;iterative-lgmres&#8217;, &#8216;svd&#8217;</td>
<td>Method used for solving for the steady-state density matrix.</td>
</tr>
<tr class="row-odd"><td>sparse</td>
<td>True, False</td>
<td>Use sparse version of direct solver.</td>
</tr>
<tr class="row-even"><td>weight</td>
<td>None</td>
<td>Allows the user to define the weighting factor used in the <tt class="docutils literal"><span class="pre">'direct'</span></tt>, <tt class="docutils literal"><span class="pre">'GMRES'</span></tt>, and <tt class="docutils literal"><span class="pre">'LGMRES'</span></tt> solvers.</td>
</tr>
<tr class="row-odd"><td>permc_spec</td>
<td>&#8216;COLAMD&#8217;, &#8216;NATURAL&#8217;</td>
<td>Column ordering used in the sparse LU decomposition.</td>
</tr>
<tr class="row-even"><td>use_rcm</td>
<td>False, True</td>
<td>Use a Reverse Cuthill-Mckee reordering to minimize the bandwidth of the modified Liouvillian used in the LU decomposition.  If <tt class="docutils literal"><span class="pre">use_rcm=True</span></tt> then the column ordering is set to <tt class="docutils literal"><span class="pre">'Natural'</span></tt> automatically unless explicitly set.</td>
</tr>
<tr class="row-odd"><td>use_umfpack</td>
<td>False, True</td>
<td>Use the umfpack solver rather than the default superLU.  on SciPy 0.14+, this option requires installing the scikits.umfpack extension.</td>
</tr>
<tr class="row-even"><td>use_precond</td>
<td>False, True</td>
<td>Attempt to generate a preconditioner when using the <tt class="docutils literal"><span class="pre">'iterative-gmres'</span></tt> and <tt class="docutils literal"><span class="pre">'iterative-lgmres'</span></tt> methods.</td>
</tr>
<tr class="row-odd"><td>M</td>
<td>None, sparse_matrix, LinearOperator</td>
<td>A user defined preconditioner, if any.</td>
</tr>
<tr class="row-even"><td>use_wbm</td>
<td>False, True</td>
<td>Use a Weighted Bipartite Matching algorithm to attempt to make the modified Liouvillian more diagonally dominate, and thus for favorable for preconditioning.  Set to <tt class="docutils literal"><span class="pre">True</span></tt> automatically when using a iterative method, unless explicitly set.</td>
</tr>
<tr class="row-odd"><td>tol</td>
<td>1e-9</td>
<td>Tolerance used in finding the solution for all methods expect <tt class="docutils literal"><span class="pre">'direct'</span></tt> and <tt class="docutils literal"><span class="pre">'svd'</span></tt>.</td>
</tr>
<tr class="row-even"><td>maxiter</td>
<td>10000</td>
<td>Maximum number of iterations to perform for all methods expect <tt class="docutils literal"><span class="pre">'direct'</span></tt> and <tt class="docutils literal"><span class="pre">'svd'</span></tt>.</td>
</tr>
<tr class="row-odd"><td>fill_factor</td>
<td>10</td>
<td>Upper-bound on the allowed fill-in for the approximate inverse preconditioner.  This value may need to be set much higher than this in some cases.</td>
</tr>
<tr class="row-even"><td>drop_tol</td>
<td>1e-3</td>
<td>Sets the threshold for the relative magnitude of preconditioner elements that should be dropped.  A lower number yields a more accurate approximate inverse at the expense of fill-in and increased runtime.</td>
</tr>
<tr class="row-odd"><td>diag_pivot_thresh</td>
<td>None</td>
<td>Sets the threshold between <span class="math">\([0,1]\)</span> for which diagonal elements are considered acceptable pivot points when using a preconditioner.</td>
</tr>
<tr class="row-even"><td>ILU_MILU</td>
<td>&#8216;smilu_2&#8217;</td>
<td>Selects the incomplete LU decomposition method algorithm used.</td>
</tr>
</tbody>
</table>
<p>Further information can be found in the <a class="reference internal" href="../apidoc/functions.html#qutip.steadystate.steadystate" title="qutip.steadystate.steadystate"><tt class="xref py py-func docutils literal"><span class="pre">qutip.steadystate.steadystate</span></tt></a> docstrings.</p>
</div>
<div class="section" id="example-harmonic-oscillator-in-thermal-bath">
<span id="steady-example"></span><h2>Example: Harmonic Oscillator in Thermal Bath<a class="headerlink" href="#example-harmonic-oscillator-in-thermal-bath" title="Permalink to this headline">¶</a></h2>
<p>A simple example of a system that reaches a steady state is a harmonic oscillator coupled to a thermal environment.  Below we consider a harmonic oscillator, initially in the <span class="math">\(\left|10\right&gt;\)</span> number state, and weakly coupled to a thermal environment characterized by an average particle expectation value of <span class="math">\(\left&lt;n\right&gt;=2\)</span>.  We calculate the evolution via master equation and Monte Carlo methods, and see that they converge to the steady-state solution.  Here we choose to perform only a few Monte Carlo trajectories so we can distinguish this evolution from the master-equation solution.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c"># number of basis states to consider</span>

<span class="gp">In [2]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">H</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span>

<span class="gp">In [4]: </span><span class="n">psi0</span> <span class="o">=</span> <span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c"># initial state</span>

<span class="gp">In [5]: </span><span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c"># coupling to oscillator</span>

<span class="gp">In [6]: </span><span class="n">c_op_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">In [7]: </span><span class="n">n_th_a</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c"># temperature with average of 2 excitations</span>

<span class="gp">In [8]: </span><span class="n">rate</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">n_th_a</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">c_op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>  <span class="c"># decay operators</span>

<span class="gp">In [10]: </span><span class="n">rate</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">*</span> <span class="n">n_th_a</span>

<span class="gp">In [11]: </span><span class="n">c_op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span>  <span class="c"># excitation operators</span>

<span class="gp">In [12]: </span><span class="n">final_state</span> <span class="o">=</span> <span class="n">steadystate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">fexpt</span> <span class="o">=</span> <span class="n">expect</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">final_state</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">tlist</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">mcdata</span> <span class="o">=</span> <span class="n">mcsolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span><span class="p">],</span> <span class="n">ntraj</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">10.0%. Run time:   0.41s. Est. time left: 00:00:00:03</span>
<span class="go">20.0%. Run time:   0.82s. Est. time left: 00:00:00:03</span>
<span class="go">30.0%. Run time:   1.17s. Est. time left: 00:00:00:02</span>
<span class="go">40.0%. Run time:   1.61s. Est. time left: 00:00:00:02</span>
<span class="go">50.0%. Run time:   2.01s. Est. time left: 00:00:00:02</span>
<span class="go">60.0%. Run time:   2.35s. Est. time left: 00:00:00:01</span>
<span class="go">70.0%. Run time:   2.65s. Est. time left: 00:00:00:01</span>
<span class="go">80.0%. Run time:   3.01s. Est. time left: 00:00:00:00</span>
<span class="go">90.0%. Run time:   3.43s. Est. time left: 00:00:00:00</span>
<span class="go">100.0%. Run time:   3.82s. Est. time left: 00:00:00:00</span>
<span class="go">Total run time:   3.87s</span>

<span class="gp">In [16]: </span><span class="n">medata</span> <span class="o">=</span> <span class="n">mesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_op_list</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span><span class="p">])</span>

<span class="gp">In [17]: </span><span class="n">figure</span><span class="p">()</span>
<span class="gh">Out[17]: </span><span class="go">&lt;matplotlib.figure.Figure at 0x10dad5910&gt;</span>

<span class="gp">In [18]: </span><span class="n">plot</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">mcdata</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">medata</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[18]: </span><span class="go"></span>
<span class="go">[&lt;matplotlib.lines.Line2D at 0x10db8d750&gt;,</span>
<span class="go"> &lt;matplotlib.lines.Line2D at 0x10db8d9d0&gt;]</span>

<span class="gp">In [19]: </span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">fexpt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span> <span class="c"># ss expt. value as horiz line (= 2)</span>
<span class="gh">Out[19]: </span><span class="go">&lt;matplotlib.lines.Line2D at 0x10da59150&gt;</span>

<span class="gp">In [20]: </span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gh">Out[20]: </span><span class="go">(0, 10)</span>

<span class="gp">In [21]: </span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go">&lt;matplotlib.text.Text at 0x10da59cd0&gt;</span>

<span class="gp">In [22]: </span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of excitations&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="gh">Out[22]: </span><span class="go">&lt;matplotlib.text.Text at 0x10da88a50&gt;</span>

<span class="gp">In [23]: </span><span class="n">legend</span><span class="p">((</span><span class="s">&#39;Monte-Carlo&#39;</span><span class="p">,</span> <span class="s">&#39;Master Equation&#39;</span><span class="p">,</span> <span class="s">&#39;Steady State&#39;</span><span class="p">))</span>
<span class="gh">Out[23]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x10d932fd0&gt;</span>

<span class="gp">In [24]: </span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Decay of Fock state $\left|10</span><span class="se">\\</span><span class="s">rangle</span><span class="se">\\</span><span class="s">right.$&#39;</span> <span class="o">+</span>
<span class="gp">   ....: </span><span class="s">&#39; in a thermal environment with $\langle n</span><span class="se">\\</span><span class="s">rangle=2$&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="gh">Out[24]: </span><span class="go">&lt;matplotlib.text.Text at 0x10da84550&gt;</span>

<span class="gp">In [25]: </span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/guide-steady1.png"><img alt="../images/guide-steady1.png" class="align-center" src="../images/guide-steady1.png" style="width: 5.0in;" /></a>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011 and later, P.D. Nation, J.R. Johansson.<br/>
      Last updated on Dec 31, 2014.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>