
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Visualization of quantum states and processes &mdash; QuTiP 3.0 Documentation</title>
    
    <link rel="stylesheet" href="../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/bootswatch-3.1.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../static/site.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="top" title="QuTiP 3.0 Documentation" href="../index.html" />
    <link rel="up" title="Users Guide" href="guide.html" />
    <link rel="next" title="Running Problems in Parallel" href="guide-parfor.html" />
    <link rel="prev" title="Plotting on the Bloch Sphere" href="guide-bloch.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          QuTiP</a>
        <span class="navbar-text navbar-version pull-left"><b>3.0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Docs <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter.html">Frontmatter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#about-this-documentation">About This Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#citing-this-project">Citing This Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#funding">Funding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#about-qutip">About QuTiP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontmatter.html#contributing-to-qutip">Contributing to QuTiP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#general-requirements">General Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#platform-independent-installation">Platform-independent installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#get-the-source-code">Get the source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-from-source">Installing from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-on-ubuntu-linux">Installation on Ubuntu Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-on-mac-os-x-10-6">Installation on Mac OS X (10.6+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-on-windows">Installation on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#verifying-the-installation">Verifying the Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#checking-version-information-using-the-about-function">Checking Version Information using the About Function</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="guide.html">Users Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="guide-overview.html">Guide Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-basics.html">Basic Operations on Quantum Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-states.html">Manipulating States and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-tensor.html">Using Tensor Products and Partial Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-dynamics.html">Time Evolution and Quantum System Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-steady.html">Solving for Steady-State Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-eseries.html">An Overview of the Eseries Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-correlation.html">Two-time correlation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-bloch.html">Plotting on the Bloch Sphere</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Visualization of quantum states and processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-parfor.html">Running Problems in Parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-saving.html">Saving QuTiP Objects and Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-random.html">Generating Random Quantum States &amp; Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide-settings.html">Modifying Internal QuTiP Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/apidoc.html">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/classes.html">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/functions.html">Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-3-0-0-july-x-2014">Version 3.0.0 (July X, 2014):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-2-0-march-01-2013">Version 2.2.0 (March 01, 2013):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-1-0-october-05-2012">Version 2.1.0 (October 05, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-0-0-june-01-2012">Version 2.0.0 (June 01, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-4-may-28-2012">Version 1.1.4 (May 28, 2012):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-3-november-21-2011">Version 1.1.3 (November 21, 2011):</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-2-october-27-2011">Version 1.1.2 (October 27, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-1-october-25-2011">Version 1.1.1 (October 25, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-1-0-october-04-2011">Version 1.1.0 (October 04, 2011)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-0-july-29-2011">Version 1.0.0 (July 29, 2011)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Developers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributors.html#lead-developers">Lead Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../biblio.html">Bibliography</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Visualization of quantum states and processes</a><ul>
<li><a class="reference internal" href="#fock-basis-probability-distribution">Fock-basis probability distribution</a></li>
<li><a class="reference internal" href="#quasi-probability-distributions">Quasi-probability distributions</a><ul>
<li><a class="reference internal" href="#wigner-function">Wigner function</a><ul>
<li><a class="reference internal" href="#custom-color-maps">Custom Color Maps</a></li>
</ul>
</li>
<li><a class="reference internal" href="#husimi-q-function">Husimi Q-function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#visualizing-operators">Visualizing operators</a></li>
<li><a class="reference internal" href="#quantum-process-tomography">Quantum process tomography</a><ul>
<li><a class="reference internal" href="#implementation-in-qutip">Implementation in QuTiP</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="guide-bloch.html" title="Previous Chapter: Plotting on the Bloch Sphere"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Plotting on the ...</span>
    </a>
  </li>
  <li>
    <a href="guide-parfor.html" title="Next Chapter: Running Problems in Parallel"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Running Problems... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="visualization-of-quantum-states-and-processes">
<span id="visual"></span><h1>Visualization of quantum states and processes<a class="headerlink" href="#visualization-of-quantum-states-and-processes" title="Permalink to this headline">¶</a></h1>
<p>Visualization is often an important complement to a simulation of a quantum
mechanical system. The first method of visualization that come to mind might be
to plot the expectation values of a few selected operators. But on top of that,
it can often be instructive to visualize for example the state vectors or
density matices that describe the state of the system, or how the state is
transformed as a function of time (see process tomography below). In this
section we demonstrate how QuTiP and matplotlib can be used to perform a few
types of  visualizations that often can provide additional understanding of
quantum system.</p>
<div class="section" id="fock-basis-probability-distribution">
<span id="visual-fock"></span><h2>Fock-basis probability distribution<a class="headerlink" href="#fock-basis-probability-distribution" title="Permalink to this headline">¶</a></h2>
<p>In quantum mechanics probability distributions plays an important role, and as
in statistics, the expectation values computed from a probability distribution
does not reveal the full story. For example, consider an quantum harmonic
oscillator mode with Hamiltonian <span class="math">\(H = \hbar\omega a^\dagger a\)</span>, which is
in a state described by its density matrix <span class="math">\(\rho\)</span>, and which on average
is occupied by two photons, <span class="math">\(\mathrm{Tr}[\rho a^\dagger a] = 2\)</span>. Given
this information we cannot say whether the oscillator is in a Fock state,
a thermal state, a coherent state, etc. By visualizing the photon distribution
in the Fock state basis important clues about the underlying state can be
obtained.</p>
<p>One convenient way to visualize a probability distribution is to use histograms.
Consider the following histogram visualization of the number-basis probability
distribution, which can be obtained from the diagonal of the density matrix,
for a few possible oscillator states with on average occupation of two photons.</p>
<p>First we generate the density matrices for the coherent, thermal and fock states.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>

<span class="gp">In [3]: </span><span class="n">rho_coherent</span> <span class="o">=</span> <span class="n">coherent_dm</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="gp">In [4]: </span><span class="n">rho_thermal</span> <span class="o">=</span> <span class="n">thermal_dm</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">rho_fock</span> <span class="o">=</span> <span class="n">fock_dm</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we plot histograms of the diagonals of the density matrices:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="gp">In [7]: </span><span class="n">bar0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="n">rho_coherent</span><span class="o">.</span><span class="n">diag</span><span class="p">())</span>

<span class="gp">In [8]: </span><span class="n">lbl0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Coherent state&quot;</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">lim0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>

<span class="gp">In [10]: </span><span class="n">bar1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="n">rho_thermal</span><span class="o">.</span><span class="n">diag</span><span class="p">())</span>

<span class="gp">In [11]: </span><span class="n">lbl1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Thermal state&quot;</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">lim1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>

<span class="gp">In [13]: </span><span class="n">bar2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="n">rho_fock</span><span class="o">.</span><span class="n">diag</span><span class="p">())</span>

<span class="gp">In [14]: </span><span class="n">lbl2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Fock state&quot;</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">lim2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>

<span class="gp">In [16]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-distribution.png"><img alt="../images/visualization-distribution.png" class="align-center" src="../images/visualization-distribution.png" style="width: 7.0in;" /></a>
<p>All these states correspond to an average of two photons, but by visualizing
the photon distribution in Fock basis the differences between these states are
easily appreciated.</p>
<p>One frequently need to visualize the Fock-distribution in the way described
above, so QuTiP provides a convenience function for doing this, see
<a class="reference internal" href="../apidoc/functions.html#qutip.visualization.plot_fock_distribution" title="qutip.visualization.plot_fock_distribution"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.plot_fock_distribution</span></tt></a>, and the following example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [17]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="gp">In [18]: </span><span class="n">plot_fock_distribution</span><span class="p">(</span><span class="n">rho_coherent</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Coherent state&quot;</span><span class="p">);</span>

<span class="gp">In [19]: </span><span class="n">plot_fock_distribution</span><span class="p">(</span><span class="n">rho_thermal</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Thermal state&quot;</span><span class="p">);</span>

<span class="gp">In [20]: </span><span class="n">plot_fock_distribution</span><span class="p">(</span><span class="n">rho_fock</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Fock state&quot;</span><span class="p">);</span>

<span class="gp">In [21]: </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="gp">In [22]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-distribution-2.png"><img alt="../images/visualization-distribution-2.png" class="align-center" src="../images/visualization-distribution-2.png" style="width: 7.0in;" /></a>
</div>
<div class="section" id="quasi-probability-distributions">
<span id="visual-dist"></span><h2>Quasi-probability distributions<a class="headerlink" href="#quasi-probability-distributions" title="Permalink to this headline">¶</a></h2>
<p>The probability distribution in the number (Fock) basis only describes the
occupation probabilities for a discrete set of states. A more complete
phase-space probability-distribution-like function for harmonic modes are
the Wigner and Husumi Q-functions, which are full descriptions of the
quantum state (equivalent to the density matrix). These are called
quasi-distribution functions because unlike real probability distribution
functions they can for example be negative. In addition to being more complete descriptions
of a state (compared to only the occupation probabilities plotted above),
these distributions are also great for demonstrating if a quantum state is
quantum mechanical, since for example a negative Wigner function
is a definite indicator that a state is distinctly nonclassical.</p>
<div class="section" id="wigner-function">
<h3>Wigner function<a class="headerlink" href="#wigner-function" title="Permalink to this headline">¶</a></h3>
<p>In QuTiP, the Wigner function for a harmonic mode can be calculated with the
function <a class="reference internal" href="../apidoc/functions.html#qutip.wigner.wigner" title="qutip.wigner.wigner"><tt class="xref py py-func docutils literal"><span class="pre">qutip.wigner.wigner</span></tt></a>. It takes a ket or a density matrix as
input, together with arrays that define the ranges of the phase-space
coordinates (in the x-y plane). In the following example the Wigner functions
are calculated and plotted for the same three states as in the previous section.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [23]: </span><span class="n">xvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="gp">In [24]: </span><span class="n">W_coherent</span> <span class="o">=</span> <span class="n">wigner</span><span class="p">(</span><span class="n">rho_coherent</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [25]: </span><span class="n">W_thermal</span> <span class="o">=</span> <span class="n">wigner</span><span class="p">(</span><span class="n">rho_thermal</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [26]: </span><span class="n">W_fock</span> <span class="o">=</span> <span class="n">wigner</span><span class="p">(</span><span class="n">rho_fock</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [27]: </span><span class="c"># plot the results</span>

<span class="gp">In [28]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="gp">In [29]: </span><span class="n">cont0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">W_coherent</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [30]: </span><span class="n">lbl0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Coherent state&quot;</span><span class="p">)</span>

<span class="gp">In [31]: </span><span class="n">cont1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">W_thermal</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [32]: </span><span class="n">lbl1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Thermal state&quot;</span><span class="p">)</span>

<span class="gp">In [33]: </span><span class="n">cont0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">W_fock</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [34]: </span><span class="n">lbl2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Fock state&quot;</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-wigner.png"><img alt="../images/visualization-wigner.png" class="align-center" src="../images/visualization-wigner.png" style="width: 7.0in;" /></a>
<div class="section" id="custom-color-maps">
<span id="visual-cmap"></span><h4>Custom Color Maps<a class="headerlink" href="#custom-color-maps" title="Permalink to this headline">¶</a></h4>
<p>The main objective when plotting a Wigner function is to demonstrate that the underlying
state is nonclassical, as indicated by negative values in the Wigner function.  Therefore,
making these negative values stand out in a figure is helpful for both analysis and publication
purposes.  Unfortunately, all of the color schemes used in Matplotlib (or any other plotting software)
are linear colormaps where small negative values tend to be near the same color as the zero values, and
are thus hidden.  To fix this dilemma, QuTiP includes a nonlinear colormap function <a class="reference internal" href="../apidoc/functions.html#qutip.visualization.wigner_cmap" title="qutip.visualization.wigner_cmap"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.wigner_cmap</span></tt></a>
that colors all negative values differently than positive or zero values.  Below is a demonstration of how to use
this function in your Wigner figures:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [37]: </span><span class="n">psi</span> <span class="o">=</span> <span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">basis</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">basis</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>

<span class="gp">In [38]: </span><span class="n">xvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="gp">In [39]: </span><span class="n">W</span> <span class="o">=</span> <span class="n">wigner</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [40]: </span><span class="n">wmap</span> <span class="o">=</span> <span class="n">wigner_cmap</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>  <span class="c"># Generate Wigner colormap</span>

<span class="gp">In [41]: </span><span class="n">nrm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="o">-</span><span class="n">W</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">W</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="gp">In [42]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="gp">In [43]: </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="gp">In [44]: </span><span class="n">plt1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">nrm</span><span class="p">)</span>

<span class="gp">In [45]: </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Standard Colormap&quot;</span><span class="p">);</span>

<span class="gp">In [46]: </span><span class="n">cb1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plt1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="gp">In [47]: </span><span class="n">plt2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">wmap</span><span class="p">)</span>  <span class="c"># Apply Wigner colormap</span>

<span class="gp">In [48]: </span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Wigner Colormap&quot;</span><span class="p">);</span>

<span class="gp">In [49]: </span><span class="n">cb2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plt2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="gp">In [50]: </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="gp">In [51]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/wigner_cmap.png"><img alt="../images/wigner_cmap.png" class="align-center" src="../images/wigner_cmap.png" style="width: 7.0in;" /></a>
</div>
</div>
<div class="section" id="husimi-q-function">
<h3>Husimi Q-function<a class="headerlink" href="#husimi-q-function" title="Permalink to this headline">¶</a></h3>
<p>The Husimi Q function is, like the Wigner function, a quasiprobability
distribution for harmonic modes. It is defined as</p>
<div class="math">
\[\begin{split}Q(\alpha) = \frac{1}{\pi}\left&lt;\alpha|\rho|\alpha\right&gt;\end{split}\]</div>
<p>where <span class="math">\(\left|\alpha\right&gt;\)</span> is a coherent state and
<span class="math">\(\alpha = x + iy\)</span>. In QuTiP, the Husimi Q function can be computed given
a state ket or density matrix using the function <a class="reference internal" href="../apidoc/functions.html#qutip.wigner.qfunc" title="qutip.wigner.qfunc"><tt class="xref py py-func docutils literal"><span class="pre">qutip.wigner.qfunc</span></tt></a>, as
demonstrated below.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [52]: </span><span class="n">Q_coherent</span> <span class="o">=</span> <span class="n">qfunc</span><span class="p">(</span><span class="n">rho_coherent</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [53]: </span><span class="n">Q_thermal</span> <span class="o">=</span> <span class="n">qfunc</span><span class="p">(</span><span class="n">rho_thermal</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [54]: </span><span class="n">Q_fock</span> <span class="o">=</span> <span class="n">qfunc</span><span class="p">(</span><span class="n">rho_fock</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>

<span class="gp">In [55]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="gp">In [56]: </span><span class="n">cont0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">Q_coherent</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [57]: </span><span class="n">lbl0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Coherent state&quot;</span><span class="p">)</span>

<span class="gp">In [58]: </span><span class="n">cont1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">Q_thermal</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [59]: </span><span class="n">lbl1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Thermal state&quot;</span><span class="p">)</span>

<span class="gp">In [60]: </span><span class="n">cont0</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">Q_fock</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="gp">In [61]: </span><span class="n">lbl2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;Fock state&quot;</span><span class="p">)</span>

<span class="gp">In [62]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-q-func.png"><img alt="../images/visualization-q-func.png" class="align-center" src="../images/visualization-q-func.png" style="width: 7.0in;" /></a>
</div>
</div>
<div class="section" id="visualizing-operators">
<span id="visual-oper"></span><h2>Visualizing operators<a class="headerlink" href="#visualizing-operators" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, it may also be useful to directly visualizing the underlying matrix
representation of an operator. The density matrix, for example, is an operator
whose elements can give insights about the state it represents, but one might
also be interesting in plotting the matrix of an Hamiltonian to inspect the
structure and relative importance of various elements.</p>
<p>QuTiP offers a few functions for quickly visualizing matrix data in the
form of histograms, <a class="reference internal" href="../apidoc/functions.html#qutip.visualization.matrix_histogram" title="qutip.visualization.matrix_histogram"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.matrix_histogram</span></tt></a> and
<a class="reference internal" href="../apidoc/functions.html#qutip.visualization.matrix_histogram_complex" title="qutip.visualization.matrix_histogram_complex"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.matrix_histogram_complex</span></tt></a>, and as Hinton diagram of weighted
squares, <a class="reference internal" href="../apidoc/functions.html#qutip.visualization.hinton" title="qutip.visualization.hinton"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.hinton</span></tt></a>. These functions takes a
<tt class="xref py py-class docutils literal"><span class="pre">qutip.Qobj.Qobj</span></tt> as first argument, and optional arguments to, for
example, set the axis labels and figure title (see the function&#8217;s documentation
for details).</p>
<p>For example, to illustrate the use of <a class="reference internal" href="../apidoc/functions.html#qutip.visualization.matrix_histogram" title="qutip.visualization.matrix_histogram"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.matrix_histogram</span></tt></a>,
let&#8217;s visualize of the Jaynes-Cummings Hamiltonian:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [63]: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [64]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">destroy</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="gp">In [65]: </span><span class="n">b</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">destroy</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="gp">In [66]: </span><span class="n">sx</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">sigmax</span><span class="p">())</span>

<span class="gp">In [67]: </span><span class="n">H</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">sx</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>

<span class="gp">In [68]: </span><span class="c"># visualize H</span>

<span class="gp">In [69]: </span><span class="n">lbls_list</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)],</span> <span class="p">[</span><span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">]]</span>

<span class="gp">In [70]: </span><span class="n">xlabels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">In [71]: </span><span class="k">for</span> <span class="n">inds</span> <span class="ow">in</span> <span class="n">tomography</span><span class="o">.</span><span class="n">_index_permutations</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls</span><span class="p">)</span> <span class="k">for</span> <span class="n">lbls</span> <span class="ow">in</span> <span class="n">lbls_list</span><span class="p">]):</span>
<span class="gp">   ....:</span>      <span class="n">xlabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">lbls_list</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">inds</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
<span class="gp">   ....:</span>                             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lbls_list</span><span class="p">))]))</span>
<span class="gp">   ....:</span> 

<span class="gp">In [72]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matrix_histogram</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="gp">In [73]: </span><span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">azim</span><span class="o">=-</span><span class="mi">55</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="gp">In [74]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-H.png"><img alt="../images/visualization-H.png" class="align-center" src="../images/visualization-H.png" style="width: 5.0in;" /></a>
<p>Similarly, we can use the function <a class="reference internal" href="../apidoc/functions.html#qutip.visualization.hinton" title="qutip.visualization.hinton"><tt class="xref py py-func docutils literal"><span class="pre">qutip.visualization.hinton</span></tt></a>, which is
used below to visualize the corresponding steadystate density matrix:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [75]: </span><span class="n">rho_ss</span> <span class="o">=</span> <span class="n">steadystate</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()])</span>

<span class="gp">In [76]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">hinton</span><span class="p">(</span><span class="n">rho_ss</span><span class="p">)</span> <span class="c">#, xlabels=xlabels, ylabels=xlabels)</span>

<span class="gp">In [77]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-rho-ss.png"><img alt="../images/visualization-rho-ss.png" class="align-center" src="../images/visualization-rho-ss.png" style="width: 5.0in;" /></a>
</div>
<div class="section" id="quantum-process-tomography">
<span id="visual-qpt"></span><h2>Quantum process tomography<a class="headerlink" href="#quantum-process-tomography" title="Permalink to this headline">¶</a></h2>
<p>Quantum process tomography (QPT) is a useful technique for characterizing experimental implementations of quantum gates involving a small number of qubits. It can also be a useful theoretical tool that can give insight in how a process transforms states, and it can be used for example to study how noise or other imperfections deteriorate a gate. Whereas a fidelity or distance measure can give a single number that indicates how far from ideal a gate is, a quantum process tomography analysis can give detailed information about exactly what kind of errors various imperfections introduce.</p>
<p>The idea is to construct a transformation matrix for a quantum process (for example a quantum gate) that describes how the density matrix of a system is transformed by the process. We can then decompose the transformation in some operator basis that represent well-defined and easily interpreted transformations of the input states.</p>
<p>To see how this works (see e.g. <a class="reference internal" href="../biblio.html#moh08" id="id1">[Moh08]</a> for more details), consider a process that is described by quantum map <span class="math">\(\epsilon(\rho_{\rm in}) = \rho_{\rm out}\)</span>, which can be written</p>
<div class="math" id="equation-qpt-quantum-map">
<span class="eqno">(1)</span>\[\epsilon(\rho_{\rm in}) = \rho_{\rm out} = \sum_{i}^{N^2} A_i \rho_{\rm in} A_i^\dagger,\]</div>
<p>where <span class="math">\(N\)</span> is the number of states of the system (that is, <span class="math">\(\rho\)</span> is represented by an <span class="math">\([N\times N]\)</span> matrix). Given an orthogonal operator basis of our choice <span class="math">\(\{B_i\}_i^{N^2}\)</span>, which satisfies <span class="math">\({\rm Tr}[B_i^\dagger B_j] = N\delta_{ij}\)</span>, we can write the map as</p>
<div class="math" id="equation-qpt-quantum-map-transformed">
<span class="eqno">(2)</span>\[\epsilon(\rho_{\rm in}) = \rho_{\rm out} = \sum_{mn} \chi_{mn} B_m \rho_{\rm in} B_n^\dagger.\]</div>
<p>where <span class="math">\(\chi_{mn} = \sum_{ij} b_{im}b_{jn}^*\)</span> and <span class="math">\(A_i = \sum_{m} b_{im}B_{m}\)</span>. Here, matrix <span class="math">\(\chi\)</span> is the transformation matrix we are after, since it describes how much <span class="math">\(B_m \rho_{\rm in} B_n^\dagger\)</span> contributes to <span class="math">\(\rho_{\rm out}\)</span>.</p>
<p>In a numerical simulation of a quantum process we usually do not have access to the quantum map in the form Eq. <a href="#equation-qpt-quantum-map">(1)</a>. Instead, what we usually can do is to calculate the propagator <span class="math">\(U\)</span> for the density matrix in superoperator form, using for example the QuTiP function <a class="reference internal" href="../apidoc/functions.html#qutip.propagator.propagator" title="qutip.propagator.propagator"><tt class="xref py py-func docutils literal"><span class="pre">qutip.propagator.propagator</span></tt></a>. We can then write</p>
<div class="math">
\[\epsilon(\tilde{\rho}_{\rm in}) = U \tilde{\rho}_{\rm in} = \tilde{\rho}_{\rm out}\]</div>
<p>where <span class="math">\(\tilde{\rho}\)</span> is the vector representation of the density matrix <span class="math">\(\rho\)</span>. If we write Eq. <a href="#equation-qpt-quantum-map-transformed">(2)</a> in superoperator form as well we obtain</p>
<div class="math">
\[\tilde{\rho}_{\rm out} = \sum_{mn} \chi_{mn} \tilde{B}_m \tilde{B}_n^\dagger \tilde{\rho}_{\rm in} = U \tilde{\rho}_{\rm in}.\]</div>
<p>so we can identify</p>
<div class="math">
\[U = \sum_{mn} \chi_{mn} \tilde{B}_m \tilde{B}_n^\dagger.\]</div>
<p>Now this is a linear equation systems for the <span class="math">\(N^2 \times N^2\)</span> elements in <span class="math">\(\chi\)</span>. We can solve it by writing <span class="math">\(\chi\)</span> and the superoperator propagator as <span class="math">\([N^4]\)</span> vectors, and likewise write the superoperator product <span class="math">\(\tilde{B}_m\tilde{B}_n^\dagger\)</span> as a <span class="math">\([N^4\times N^4]\)</span> matrix <span class="math">\(M\)</span>:</p>
<div class="math">
\[U_I = \sum_{J}^{N^4} M_{IJ} \chi_{J}\]</div>
<p>with the solution</p>
<div class="math">
\[\chi = M^{-1}U.\]</div>
<p>Note that to obtain <span class="math">\(\chi\)</span> with this method we have to construct a matrix <span class="math">\(M\)</span> with a size that is the square of the size of the superoperator for the system. Obviously, this scales very badly with increasing system size, but this method can still be a very useful for small systems (such as system comprised of a small number of coupled qubits).</p>
<div class="section" id="implementation-in-qutip">
<h3>Implementation in QuTiP<a class="headerlink" href="#implementation-in-qutip" title="Permalink to this headline">¶</a></h3>
<p>In QuTiP, the procedure described above is implemented in the function <a class="reference internal" href="../apidoc/functions.html#qutip.tomography.qpt" title="qutip.tomography.qpt"><tt class="xref py py-func docutils literal"><span class="pre">qutip.tomography.qpt</span></tt></a>, which returns the <span class="math">\(\chi\)</span> matrix given a density matrix propagator. To illustrate how to use this function, let&#8217;s consider the <span class="math">\(i\)</span>-SWAP gate for two qubits. In QuTiP the function <tt class="xref py py-func docutils literal"><span class="pre">qutip.gates.iswap</span></tt> generates the unitary transformation for the state kets:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [78]: </span><span class="n">U_psi</span> <span class="o">=</span> <span class="n">iswap</span><span class="p">()</span>
</pre></div>
</div>
<p>To be able to use this unitary transformation matrix as input to the function <a class="reference internal" href="../apidoc/functions.html#qutip.tomography.qpt" title="qutip.tomography.qpt"><tt class="xref py py-func docutils literal"><span class="pre">qutip.tomography.qpt</span></tt></a>, we first need to convert it to a transformation matrix for the corresponding density matrix:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [79]: </span><span class="n">U_rho</span> <span class="o">=</span> <span class="n">spre</span><span class="p">(</span><span class="n">U_psi</span><span class="p">)</span> <span class="o">*</span> <span class="n">spost</span><span class="p">(</span><span class="n">U_psi</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span>
</pre></div>
</div>
<p>Next, we construct a list of operators that define the basis <span class="math">\(\{B_i\}\)</span> in the form of a list of operators for each composite system. At the same time, we also construct a list of corresponding labels that will be used when plotting the <span class="math">\(\chi\)</span> matrix.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [80]: </span><span class="n">op_basis</span> <span class="o">=</span> <span class="p">[[</span><span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sigmax</span><span class="p">(),</span> <span class="n">sigmay</span><span class="p">(),</span> <span class="n">sigmaz</span><span class="p">()]]</span> <span class="o">*</span> <span class="mi">2</span>

<span class="gp">In [81]: </span><span class="n">op_label</span> <span class="o">=</span> <span class="p">[[</span><span class="s">&quot;i&quot;</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
<p>We are now ready to compute <span class="math">\(\chi\)</span> using <a class="reference internal" href="../apidoc/functions.html#qutip.tomography.qpt" title="qutip.tomography.qpt"><tt class="xref py py-func docutils literal"><span class="pre">qutip.tomography.qpt</span></tt></a>, and to plot it using <a class="reference internal" href="../apidoc/functions.html#qutip.tomography.qpt_plot_combined" title="qutip.tomography.qpt_plot_combined"><tt class="xref py py-func docutils literal"><span class="pre">qutip.tomography.qpt_plot_combined</span></tt></a>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [82]: </span><span class="n">chi</span> <span class="o">=</span> <span class="n">qpt</span><span class="p">(</span><span class="n">U_rho</span><span class="p">,</span> <span class="n">op_basis</span><span class="p">)</span>

<span class="gp">In [83]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">qpt_plot_combined</span><span class="p">(</span><span class="n">chi</span><span class="p">,</span> <span class="n">op_label</span><span class="p">,</span> <span class="s">r&#39;$i$SWAP&#39;</span><span class="p">)</span>

<span class="gp">In [84]: </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../images/visualization-chi-iswap.png"><img alt="../images/visualization-chi-iswap.png" class="align-center" src="../images/visualization-chi-iswap.png" style="width: 5.0in;" /></a>
<p>For a slightly more advanced example, where the density matrix propagator is calculated from the dynamics of a system defined by its Hamiltonian and collapse operators using the function <a class="reference internal" href="../apidoc/functions.html#qutip.propagator.propagator" title="qutip.propagator.propagator"><tt class="xref py py-func docutils literal"><span class="pre">qutip.propagator.propagator</span></tt></a>, see notebook &#8220;Time-dependent master equation: Landau-Zener transitions&#8221; on the tutorials section on the QuTiP web site.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011 and later, P.D. Nation, J.R. Johansson.<br/>
      Last updated on Jul 16, 2014.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>